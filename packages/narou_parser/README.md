# なろう小説html to Novelty用jsonパーサー

## 概要

「小説家になろう」の小説HTML（`<p>`, `<br>`, `<ruby>` タグなど）を、Novelty アプリで使用する `NovelContentElement` リストにパースするパッケージです。

## パーサーの種類

- **Stable Parser** (`parseNovelContent`) - 安定版。package:html を使用した DOMベースのパーサー
- **Fast Parser** (`parseNovelContentFast`) - 実験版。正規表現ベースの高速パーサー
- **Ultra Parser** (`parseNovelContentUltra`) - 実験版。文字列スキャンベースの超高速パーサー

## ベンチマーク

### 実行方法

```bash
# 通常パーサーのベンチマーク
dart run benchmark/stable_parser_benchmark.dart

# 全パーサーの比較ベンチマーク
dart run benchmark/all_parsers_benchmark.dart
```

### ベンチマーク結果

#### Stable Parser (通常パーサー) - Baseline

**実行環境**: Windows 11, Dart SDK
**測定日**: 2025-11-29
**バージョン**: v0.1.0 (最適化前)

| シナリオ | 行数 | データサイズ | 平均時間 | ms/1k行 |
|---------|------|------------|---------|---------|
| 小規模     |   1,000 |     73.4 KB |       9 ms |    9.00 |
| 中規模     |  10,000 |    734.4 KB |      50 ms |    5.00 |
| 大規模     |  50,000 |   3671.9 KB |     250 ms |    5.00 |
| 超大規模    | 100,000 |   7343.8 KB |     504 ms |    5.04 |

**詳細結果**:

```
=== 通常パーサー (Stable DOM Parser) ベンチマーク ===

----------------------------------------
シナリオ: 小規模 (1000行)
  データサイズ: 75200 chars (73.44 KB / 0.07 MB)

  [パフォーマンス] (3回実行)
  最小時間: 6 ms
  平均時間: 9 ms
  中央値:   9 ms
  最大時間: 13 ms
  スループット: 111111 行/秒
  処理速度:     9.00 ms/1k行

  [出力]
  要素数: 5700
----------------------------------------

----------------------------------------
シナリオ: 中規模 (10000行)
  データサイズ: 752000 chars (734.38 KB / 0.72 MB)

  [パフォーマンス] (3回実行)
  最小時間: 47 ms
  平均時間: 50 ms
  中央値:   48 ms
  最大時間: 56 ms
  スループット: 200000 行/秒
  処理速度:     5.00 ms/1k行

  [出力]
  要素数: 57000
----------------------------------------

----------------------------------------
シナリオ: 大規模 (50000行)
  データサイズ: 3760000 chars (3671.88 KB / 3.59 MB)

  [パフォーマンス] (3回実行)
  最小時間: 240 ms
  平均時間: 250 ms
  中央値:   252 ms
  最大時間: 258 ms
  スループット: 200000 行/秒
  処理速度:     5.00 ms/1k行

  [出力]
  要素数: 285000
----------------------------------------

----------------------------------------
シナリオ: 超大規模 (100000行)
  データサイズ: 7520000 chars (7343.75 KB / 7.17 MB)

  [パフォーマンス] (3回実行)
  最小時間: 501 ms
  平均時間: 504 ms
  中央値:   501 ms
  最大時間: 511 ms
  スループット: 198413 行/秒
  処理速度:     5.04 ms/1k行

  [出力]
  要素数: 570000
----------------------------------------
```